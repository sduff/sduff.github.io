<!DOCTYPE html>
<html lang="en">

<head>
   <link rel="icon" href="/favicon.png" />

   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">

   <link rel="stylesheet" href="https://fonts.xz.style/serve/inter.css">
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">

   <!-- highlight.js code formatter -->
   <link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/nord.min.css">
   <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js"></script>
   <!-- remove styled padding on pre in code -->
   <style>
      pre { padding: 0; }
   </style>

   <title></title>
   <meta name="description" content="">
   <meta name="author" content="Simon Duff" />
</head>
<body>
<header>
<h1>Simon Duff</h1>
   <nav>
      <a href="https://newcss.net">Home</a> /
      <a href="https://newcss.net/usage/">Usage</a> /
      <a href="https://newcss.net/usage/elements/">Elements</a> /
      <a href="https://newcss.net/themes/">Themes</a> /
      <a href="https://github.com/xz/new.css">GitHub</a> / 
      <a href="https://discord.gg/hhuuC4w">Discord</a>
   </nav>
</header>
<p>title:
date: 2017-09-28
tags: [web]
published: true
layout: default
title: Sitemap pings for GitHub-hosted Jekyll sites</p>
<hr />
<h1>Sitemap pings for GitHub-hosted Jekyll sites</h1>
<h2>What is a sitemap?</h2>
<p>According to a <a href="https://googlepress.blogspot.com.au/2006/11/major-search-engines-unite-to-support_16.html">news
release</a>
by Google, Yahoo and Microsoft, a sitemap is <em>a free and easy way for
webmasters to notify search engines about their websites and be indexed more
comprehensively and efficiently</em>. Essentially, it is an XML document that
describes the various pages of a website, including their relative importance
and update frequency. Although these search engines have crawlers that will
index websites, pinging them with a sitemap might help guide their attention.</p>
<h2>Generating a sitemap with Jekyll</h2>
<p>The easiest way to generate a sitemap in Jekyll is to use the <a href="https://github.com/jekyll/jekyll-sitemap">Jekyll Sitemap
plugin</a>. The plugin is <a href="https://help.github.com/articles/sitemaps-for-github-pages/">already
installed</a> on
GitHub, so using it is as simple as including the following stanza in the
site's <code>_config.yaml</code></p>
<pre><code class="language-yaml">plugins:
  - jekyll-sitemap
</code></pre>
<p>For my website, I required a little more customisation, so created a file
called
<a href="https://github.com/sduff/sduff.github.io/blob/master/sitemap.xml">sitemap.xml</a>
in the website root directory.</p>
<pre><code class="language-html">{% raw %}---
layout: none
sitemap:
  exclude: 'yes'
---
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;&gt;
{% assign docs = site:docs | reverse docs %}
  {% for page in docs %}
    {% unless page.sitemap.exclude == &quot;yes&quot; %}
    &lt;url&gt;
      &lt;loc&gt;{{ site.url }}{{ page.url | remove: &quot;index.html&quot; }}&lt;/loc&gt;
      {% if page.sitemap.lastmod %}
        &lt;lastmod&gt;{{ page.sitemap.lastmod | date: &quot;%Y-%m-%d&quot; }}&lt;/lastmod&gt;
      {% elsif page.date %}
        &lt;lastmod&gt;{{ page.date | date_to_xmlschema }}&lt;/lastmod&gt;
      {% else %}
        &lt;lastmod&gt;{{ site.time | date_to_xmlschema }}&lt;/lastmod&gt;
      {% endif %}
      {% if page.sitemap.changefreq %}
        &lt;changefreq&gt;{{ page.sitemap.changefreq }}&lt;/changefreq&gt;
      {% else %}
        &lt;changefreq&gt;monthly&lt;/changefreq&gt;
      {% endif %}
      {% if page.sitemap.priority %}
        &lt;priority&gt;{{ page.sitemap.priority }}&lt;/priority&gt;
      {% else %}
        &lt;priority&gt;0.3&lt;/priority&gt;
      {% endif %}
    &lt;/url&gt;
    {% endunless %}
  {% endfor %}
&lt;/urlset&gt;{% endraw %}
</code></pre>
<p>These Jekyll directives generate the relevant XML code for each page in my web
site, generating a <a href="http://simonduff.net/sitemap.xml">valid sitemap.xml</a> as the
output.</p>
<h2>Github webhooks</h2>
<p>GitHub allows for webhooks to be attached to actions in a repository. In this
case, there should be a push to the various search engines to notify them that
the sitemap has been updated. To do so, the following URLs need to be called,
either by a <code>GET</code> or <code>POST</code> request.</p>
<pre><code class="language-bash">https://www.google.com/webmasters/tools/ping?sitemap=http://simonduff.net/sitemap.xml
http://www.bing.com/ping?sitemap=http://simonduff.net/sitemap.xml
</code></pre>
<p>To configure, go to website repository's Settings section, and locate the
section called <code>Webhooks</code>.</p>
<p><img src="/img/github_settings_webhooks.png" alt="GitHub Settings Webhooks" title="GitHub Settings Webhooks" /></p>
<p>Configure webhooks for Google, Bing and any other search engine with sitemap submission facilities.</p>
<p><img src="/img/github_webhook_google.png" alt="Google Webhook" title="Webhook configuration for Google" />
<img src="/img/github_webhook_bing.png" alt="Bing Webhook" title="WebHook configuration for Bing" /></p>
<p>After your next website push, you can check the responses of the two pings by
going to the individual webhook pages and checking the <code>responses</code>.</p>

<script>hljs.highlightAll();</script>
</body>
</html>
